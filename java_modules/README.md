
## JAVA 모듈


### Response

Response에 대해서 많이 고민하고 있습니다.

현재 가장 무난하게 사용하는 것은 ResponseEntity를 사용하는 것이지만 의견이 갈리는 이유는 결국 Error는 @RestControllerAdvice 로 빠지기 때문에 HTTP 상태를 Error로 변경하지 않고 정상 OK로 리턴하기 때문에 Custom한 Response 객체를 사용해도 된다. 라는 것입니다.

이 것에 대해서 고민했었는데 프론트도 직접 개발해본 결과 정말 500번대의 서버오류라면 Error 상태 값으로 보내는 것이 올바르다고 생각합니다. 이유는

Axios, Ajax 등 Promise를 반환하는 비동기 통신 기술을 사용할 때 catch로 모듈화 해서 잡는 것이 편하기 때문입니다. 실무를 하면서 사수의 경우 await를 사용해서 반환 값을 받아서 처리하고 then을 사용하지 않으셨습니다. 물론 경우에 따라 반환 값을 받아서 사용하는 것이 가시성이 좋을 수 있고 필요한 경우도 존재한다고 생각합니다. 하지만 then을 활용하고 catch를 활용하는 것이 어떻게 보면 더 명확하게 표현할 수 있고 결과 값에 따른 조건문의 책임을 전가하지 않을 수 있다고 생각합니다.

따라서 저는 ResponseEntity를 사용하는 것이 올바르다고 생각합니다. 하지만 Map이나 Response Custom 객체를 활용하는 방안에 대해서 알아보고 싶어서 만들게 되었습니다.

결과 코드를 HttpStatus로 하는 것이 의미가 있진 않아서 Enum으로 Code를 구현하고 제공하도록 설계할까도 고민하고 있습니다.

빌더 패턴을 사용해서 간단하게 리턴하도록 만들었고 T 제네릭을 통해 반환 할 오브젝트의 타입이 반환 값을 지정하여 받을 수 있도록 했습니다. 그리고 내부 정적 클래스로 Builder를 구현했기 때문에 this를 사용해서 클래스의 변수 값이 설정되도록 하는 방법을 선택했습니다.

final 멤버 변수를 통해 생성자에 필수적으로 들어가야할 매개 변수를 지정함으로써 메세지, 코드를 필수적으로 리턴할 수 있도록 빌더 패턴을 사용했습니다. 이유는 Error일 경우 메세지 , Code는 프론트에서 반드시 알아야한다고 생각했기 때문입니다.

data의 경우 반환 될 Object ( DTO ) total의 경우 게시판과 같은 페이징이 필요하거나 갯수를 표시해야할 리스트의 경우 필요하다고 판단되어 넣었습니다.

다 만들고나서 생각했던 것은 ResponseEntity와 생성한 Response의 객체 생성 비용의 차이가 얼마나 날까. 라는 의문점도 들었습니다.

두 번째로 KeyCloak와 같은 외부 인가 서버를 사용한다면 모듈에 ResponseEntity를 통해서 리턴해야하는 상황이 발생했습니다. 그럴 때 2중으로 처리하기 보다는 ResponseEntity를 사용했다면 한 번으로 처리가 가능했기 때문에 ResponseEntity가 좀 더 올바른 판단이 되지 않을까 싶습니다.

그래서 마지막으로 리팩토링을 진행했습니다.
